# mysql 随机数

rand() 函数可以随即产生值介于[ 0，1 ]之间的浮点数.

mysql> select rand(),rand(),rand();
+--------------------+--------------------+---------------------+
| rand()             | rand()             | rand()              |
+--------------------+--------------------+---------------------+
| 0.9467406728740229 | 0.6173033524465779 | 0.24629477434446548 |
+--------------------+--------------------+---------------------+
1 row in set (0.01 sec)

配合round() 函数,我们可以模拟随即整数.

mysql> select round(rand()*1),round(10*rand()),round(10*rand()+5);
+-----------------+------------------+--------------------+
| round(rand()*1) | round(10*rand()) | round(10*rand()+5) |
+-----------------+------------------+--------------------+
|               0 |                2 |                 12 |
+-----------------+------------------+--------------------+
1 row in set (0.00 sec)

上边随机模拟了 [0-1],[0,10],[5,15]之间的整数.

## 伪造测试数据

mysql> insert into user(name,email) values(concat_ws('_','sujianhui',ROUND(RAND() * 5444 + 234)),concat_ws('',ROUND(RAND() * 5444 + 234), '@qq.com'));


## 伪造时间

 - FROM_UNIXTIME(unix_timestamp)： 时间戳 转 日期
 - UNIX_TIMESTAMP(date)：          日期  转 时间戳

mysql 还有 php的时间戳 都是 10位的.

mysql> select unix_timestamp('2020-08-01');
+------------------------------+
| unix_timestamp('2020-08-01') |
+------------------------------+
|                   1596211200 |
+------------------------------+
1 row in set (0.00 sec)


[sujianhui@localhost mysql]$>php -r "echo time();"
1600222471

放大招

mysql> select from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) );
+------------------------------------------------------------------------------+
| from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ) |
+------------------------------------------------------------------------------+
| 2020-08-02 10:16:34                                                          |
+------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) );
+------------------------------------------------------------------------------+
| from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ) |
+------------------------------------------------------------------------------+
| 2020-08-25 20:39:39                                                          |
+------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) );
+------------------------------------------------------------------------------+
| from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ) |
+------------------------------------------------------------------------------+
| 2020-08-01 00:28:33                                                          |
+------------------------------------------------------------------------------+
1 row in set (0.00 sec)

因为我的子段是 datetime 类型，需要去掉后边 秒部分.先看两个函数.


mysql> select now();
+---------------------+
| now()               |
+---------------------+
| 2020-09-16 10:26:50 |
+---------------------+
1 row in set (0.00 sec)

mysql> select date_format(now(), '%Y-%m-%d');
+--------------------------------+
| date_format(now(), '%Y-%m-%d') |
+--------------------------------+
| 2020-03-18                     |
+--------------------------------+
1 row in set (0.00 sec)

mysql> select date_format('2018-01-15 09:45:16', '%Y-%m-%d');
+------------------------------------------------+
| date_format('2018-01-15 09:45:16', '%Y-%m-%d') |
+------------------------------------------------+
| 2018-01-15                                     |
+------------------------------------------------+
1 row in set (0.00 sec)


强化版本 随机生成8月份的日期.

mysql> select date_format(from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ),'%Y-%m-%d');
+------------------------------------------------------------------------------------------------------+
| date_format(from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ),'%Y-%m-%d') |
+------------------------------------------------------------------------------------------------------+
| 2020-08-18                                                                                           |
+------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select date_format(from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ),'%Y-%m-%d');
+------------------------------------------------------------------------------------------------------+
| date_format(from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ),'%Y-%m-%d') |
+------------------------------------------------------------------------------------------------------+
| 2020-08-12                                                                                           |
+------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> insert into act(type,st,ed,status) values(round(rand() + 11),date_format(from_unixtime( round( 86400 * 30 * rand()  + unix_timestamp('2020-08-01')) ),'%Y-%m-%d'),date_format(from_unixtime( round( 86400 *
30 * rand()  + unix_timestamp('2020-09-01')) ),'%Y-%m-%d'),round(rand()));
Query OK, 1 row affected (0.01 sec)


create table act(
    id int unsigned not null auto_increment primary key,
    type int unsigned not null default 0,
    st datetime,
    ed datetime,
    status tinyint
)engine=innodb

