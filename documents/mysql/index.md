## 索引

##### 什么是索引 

索引是一种数据结构（或者说是一种特殊的文件）,索引保存为一个文件，它是要占据物理空间的。索引本身是有序的.
索引的实现通常使用B树及其变种B+树。

使用索引查询一定能提高查询的性能吗？

因为索引需要额外的存储空间和处理，那些不必要的索引反而会使查询反应时间变慢。使用索引查询不一定能提高查询性能.

##### 创建索引的原则（重中之重）

索引虽好，但也不是无限制的使用，最好符合一下几个原则

1）组合索引创建要考虑最左前缀匹配原则，非常重要的原则，mysql会一直向右匹配直到遇到范围查询(>、<、between、like)就停止匹配
2）较频繁作为查询条件的字段才去创建索引,order by 的数据列也要考虑建立索引.
3）更新频繁字段不适合创建索引(每次更新数据 都要同步索引 性能开销大)
4）分辨度太低的数据列不适合做索引列(如性别，男女未知，最多也就三种，区分度实在太低)
5）尽量的扩展索引，不要新建索引。比如表中已经有a的索引，现在要加(a,b)的索引，那么只需要修改原来的索引即可。
6）定义有外键的数据列一定要建立索引。
7）对于那些查询中很少涉及的列，重复值比较多的列不要建立索引。
8）对于定义为text、image和bit的数据类型的列不要建立索引。
9）NULL值：应该指定列为NOT NULL，除非你想存储NULL。在mysql中，含有空值的列很难进行查询优化，因为它们使得索引、索引的统计信息以及比较运算更加复杂。你应该用0、一个特殊的值或者一个空串代替空值；

一个实际的例子

MySQL有一个复合索引：INDEX(`a`, `b`, `c`)，以下查询能用上索引的有？

 - A、select * from users where a = 1 and b = 2    可以使用 a,b
 - B、select * from users where b = 2 and a = 1    可以使用a,b 优化器
 - C、select * from users where a = 2 and c = 1    可以使用a, c 因为中间隔了一个b,不能生效
 - D、select * from users where b = 2 and c = 1    不能使用索引


#### 索引分类

聚簇索引
    主键索引
非聚簇索引
    普通索引
    唯一索引
    全文索引
    多列索引 <=> 组合索引 <=> 联合索引 <=> 复合索引
    前缀索引

##### 索引覆盖

索引覆盖是一种现象,如果要查询的字段都建立过索引，那么引擎会直接在索引表中查询而不会访问原始数据（不用再次回表查询,否则只要有一个字段没有建立索引就会做全表扫描）。

##### 最左前缀

MySQL使用索引时需要索引有序，假设现在建立了"name，age，school"的联合索引，那么索引的排序为: 
先按照name排序，如果name相同，则按照age排序，如果age的值也相等，则按照school进行排序。
因此在建立联合索引的时候应该注意索引列的顺序，一般情况下，将查询需求频繁或者字段选择性高的列放在前面。
